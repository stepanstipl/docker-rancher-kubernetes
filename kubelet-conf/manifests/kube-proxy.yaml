apiVersion: v1
kind: Pod
metadata:
  name: kube-proxy
  namespace: kube-system
spec:
  hostNetwork: true
  containers:
    - name: kube-proxy
      image: gcr.io/google_containers/hyperkube:v1.1.3
      command:
        - /bin/sh
        - -c
        - /hyperkube proxy
          --bind-address=0.0.0.0
          --healthz-port=10249
          --healthz-bind-address=127.0.0.1
          --master={{ K8S_MASTER }}
          --proxy-mode=iptables
          --v2 --logtostderr=true 1>>/var/log/kube-proxy.log 2>&1
      securityContext:
        privileged: true
      volumeMounts:
        - mountPath: /var/log/kube-proxy.log
          name: logfile
        - mountPath: /srv/kubernetes
          name: srvkube
          readOnly: true
  volumes:
    - hostPath:
        path: /srv/kubernetes
      name: kubeconfig
    - hostPath:
        path: /var/log/kube-proxy.log
      name: logfile
